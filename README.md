# AI-Driven Stock Market Analysis: Integrating Multimodal Data and Machine Learning for Predictive Insights

## 📈 AI-Driven Stock Market Analysis  
*A comprehensive framework for stock market forecasting using time series analysis, news sentiment integration, and deep learning.*

---

## 📖 Project Overview  
This project integrates **multimodal data sources** (historical stock prices, technical indicators, and news sentiment) with machine learning models to provide actionable insights into stock market trends. It combines quantitative analysis (LSTM forecasting, volatility clustering, backtesting) with qualitative news sentiment analysis via the DeepSeek API to generate trading recommendations. The system is designed for academic research and exploratory financial analysis.

---

## ✨ Key Features  
1. **Time Series Analysis**  
   - Technical indicators (RSI, MACD, ADX, Bollinger Bands).  
   - Volatility clustering and anomaly detection.  
   - Interactive visualizations using Plotly and Matplotlib.  

2. **News Sentiment Integration**  
   - Web scraping from Google News, Yahoo Finance, Sina, and AAStocks.  
   - Sentiment aggregation for AI-driven analysis.  

3. **Predictive Modeling**  
   - LSTM-based price forecasting (univariate and multivariate).  
   - Backtesting strategies using Backtrader.  

4. **AI-Powered Recommendations**  
   - Integration with DeepSeek API for risk assessment and trading signals.  
   - Automated report generation with buy/sell recommendations.  

---

## 🛠️ Installation  
1. **Clone the Repository**  
   ```bash  
   git clone https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis.git
   cd AI-Driven-Stock-Market-Analysis
   ```  

2. **Install Dependencies**  
   ```bash  
   pip install -r requirements.txt  
   ```  

3. **Set Up Environment Variables**  
   - Add your DeepSeek API key to `deepseek_integration.py`:  
     ```python  
     api_key = 'your-api-key-here'  
     ```  

4. **Create Output Directories**  
   ```bash  
   mkdir -p ./output/{stock_id}  # Replace {stock_id} with target ticker (e.g., 01810)  
   ```  

---

## 🚀 Usage  

### 1. Fetch Historical Data & Run Analysis  
```bash  
python time_series_analysis.py --ticker "01810.HK" --years 10  
```  
- Outputs: Enhanced CSV files, interactive charts, and statistical reports.  

### 2. Scrape News Articles  
```bash  
python web_crawlers.py --ticker "01810.HK" 
```  
- Outputs: CSV files in `./output/{stock_id}/` with news from Google, Yahoo, Sina, and AAStocks.  

### 3. Generate AI Recommendations  
```bash  
python deepseek_integration.py --ticker "01810.HK" --model "deepseek-reasoner"
```  
- Outputs: `Deepseet_Output.txt` with trading signals and risk assessments.  

---

## 📂 Project Structure  
```
├── assets/
├── src/  
│   ├── data_fetch.py           # Yahoo Finance data retrieval  
│   ├── preprocessing.py        # Technical indicators and feature engineering  
│   ├── visualization.py        # Interactive charts  
│   ├── advanced_analysis.py    # Volatility clustering, backtesting  
│   ├── news_scraper.py         # Web crawlers for news aggregation  
│   ├── deepseek_integration.py # AI analysis pipeline  
│   └── price_forecast.py       # LSTM models for forecasting  
├── output/                     # Generated reports, charts, and models
├── main.ipynb
├── time_series_analysis.py
├── web_crawlers.py
├── deepseek_integration.py
├── requirements.txt            # Dependency list  
└── README.md  
```  

---

## 📊 Example Outputs  
1. **Interactive Dashboard**  
   ![Interactive Chart Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/interactive_chart.gif)  

2. **Return Distribution**
   ![Return Distribution Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/return_distribution_20250521.png)

3. **Volatility Clustering**
   ![Volatility Clustering Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/volatility_clustering_20250521.png)

4. **Anomaly Detection**
   ![Anomaly Detection Example](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/output/01810/anomaly_detection_20250521.png)

5. **LSTM Price Forecast**  
   ![Forecast Example 1](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/single-feature_lstm.png)
   ![Forecast Example 2](https://github.com/LutherYTT/AI-Driven-Stock-Market-Analysis/blob/main/asstes/multifeature_lstm.png)  

6. **DeepSeek Analysis Report**
   [WARNING] This answer was generated by AI and is for informational purposes only, so please screen it carefully.
   ```
   Here’s the analysis for Xiaomi Corporation (01810.HK) based on the provided data and news:
   ---
   ### **Stock Risk Level (1-10):**  
   **6** (Moderate-High Risk)  
   *Explanation:* The stock has shown strong upward momentum recently (RSI near 68, approaching overbought), but the high volatility (4.65 over 30 days) and mixed market sentiment (global debt concerns, tech sector competition) add risk.  
   ---
   ### **Stock Trend:**  
   **Up**  
   *Explanation:* The stock is trading above all key moving averages (MA20/50/200), indicating a bullish trend. The RSI (67.85) suggests upward momentum but is nearing overbought territory.  
   ---
   ### **Short-Term Forecast (~5 days):**  
   **Small Up / Volatile**  
   *Explanation:* The imminent product launch (3nm "玄戒O1" chip and YU7 SUV) could drive short-term bullish sentiment, but profit-taking may occur after the news. 
   ---
   ### **Mid-Term Forecast (~30 days):**  
   **Small Up / Consolidation**  
   *Explanation:* Positive catalysts (chip/auto demand, potential inclusion in indices) may sustain gains, but macroeconomic risks (U.S. debt concerns, tech sector volatility) could limit upside.  
   ---
   ### **News Sentiment [1-10]:**  
   **7** (Moderately Positive)  
   *Explanation:* News highlights Xiaomi’s breakthroughs (3nm chip, YU7 SUV) and strong ecosystem growth, but some skepticism exists about execution risks and competition.  
   ---
   ### **Suggested Buy Price:**  
   **HK$52.00–53.00**  
   *Explanation:* A pullback to the 20-day MA (~HK$50) or near HK$52 would offer a better risk-reward entry.  
   ---
   ### **Suggested Sell Price:**  
   **HK$58.00–60.00**  
   *Explanation:* Resistance near the 30-day high (HK$54.80); extended rally could test HK$60 if chip/auto news exceeds expectations.  
   ---
   ### **Short Comment:**  
   Xiaomi’s dual catalysts (chip + auto) justify bullishness, but RSI and volatility warrant caution. Short-term traders could capitalize on the event-driven spike, while long-term investors should monitor chip adoption and YU7 delivery timelines.  
   --- 
   *Note: Market risks (global tech sell-offs, geopolitical tensions) could override company-specific positives. Adjust positions based on post-launch volume/price action.*
   [WARNING] This answer was generated by AI and is for informational purposes only, so please screen it carefully.
   ```  

---

## ⚠️ Disclaimer  
This project is for **academic and informational purposes only**. Stock market investments carry risks, and the predictions generated by this system should not be treated as financial advice. Always conduct independent research or consult a professional advisor.  

---

## 🙌 Acknowledgments  
- Libraries: `yfinance`, `Backtrader`, `Plotly`, `TensorFlow`.  
- Data Sources: Yahoo Finance, Google News, Sina, AAStocks.  
- AI Integration: DeepSeek API.
